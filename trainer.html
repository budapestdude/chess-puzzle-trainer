<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Training System</title>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <link rel="stylesheet" href="trainer.css">
    <style>
        #sidebarUsername {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
            padding: 5px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        #sidebarUsername:hover {
            color: var(--accent);
            background: rgba(0, 212, 255, 0.1);
            transform: translateX(5px);
        }
        
        .user-stats {
            margin: 15px 0;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .user-stats div {
            padding: 4px 0;
        }
    </style>
</head>
<body>
    <!-- Background elements -->
    <div class="background"></div>
    <div class="grid-overlay"></div>
    
    <div class="trainer-layout">
        <!-- Left Sidebar - Navigation & Filters -->
        <aside class="left-sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">
                    <div class="logo-icon">‚ôüÔ∏è</div>
                    ChessTactics
                </div>
                <button class="btn" onclick="window.location.href='/';">‚Üê Back to Home</button>
            </div>

            <!-- User Info Section -->
            <div class="sidebar-section" id="userSection">
                <h3>User Profile</h3>
                <div class="user-info">
                    <div class="username" id="sidebarUsername" onclick="window.location.href='/profile.html'" style="cursor: pointer; transition: color 0.3s ease;">Guest</div>
                    <div class="user-stats">
                        <div>Rating: <span id="sidebarRating">1200</span></div>
                        <div>Streak: <span id="sidebarStreak">0</span></div>
                        <div>Today: <span id="sidebarToday">0</span></div>
                    </div>
                    <button class="btn" onclick="window.location.href='/profile.html'" style="margin-bottom: 10px;">View Full Profile</button>
                    <button class="btn" id="sidebarLogout">Logout</button>
                </div>
            </div>


            <!-- Training Mode -->
            <div class="sidebar-section">
                <h3>Training Mode</h3>
                <button class="btn mode-btn active" data-mode="practice">Practice</button>
                <button class="btn mode-btn" data-mode="rated">Rated</button>
                <button class="btn mode-btn" data-mode="review">Review</button>
                <button class="btn mode-btn" data-mode="rush">‚ö° Rush Mode</button>
            </div>

            <!-- Rush Options -->
            <div class="sidebar-section" id="rushOptions" style="display: none;">
                <h3>Rush Mode</h3>
                <button class="btn rush-type-btn active" data-rush="3min">3 Minutes</button>
                <button class="btn rush-type-btn" data-rush="5min">5 Minutes</button>
                <button class="btn rush-type-btn" data-rush="survival">Survival</button>
            </div>

            <!-- Categories -->
            <div class="sidebar-section">
                <h3>Categories</h3>
                <div id="categoryList">
                    <button class="btn">All Categories</button>
                </div>
            </div>

            <!-- Difficulty -->
            <div class="sidebar-section">
                <h3>Difficulty</h3>
                <div class="difficulty-options">
                    <label style="color: white; display: block; margin-bottom: 8px;">
                        <input type="checkbox" name="difficulty" value="1" checked style="margin-right: 8px;">
                        ‚≠ê Beginner
                    </label>
                    <label style="color: white; display: block; margin-bottom: 8px;">
                        <input type="checkbox" name="difficulty" value="2" checked style="margin-right: 8px;">
                        ‚≠ê‚≠ê Intermediate
                    </label>
                    <label style="color: white; display: block;">
                        <input type="checkbox" name="difficulty" value="3" checked style="margin-right: 8px;">
                        ‚≠ê‚≠ê‚≠ê Advanced
                    </label>
                </div>
            </div>

            <!-- Themes -->
            <div class="sidebar-section">
                <h3>Themes</h3>
                <div class="theme-options" id="themeList">
                    <label style="color: white; display: block; margin-bottom: 8px;">
                        <input type="checkbox" name="theme" value="all" checked style="margin-right: 8px;">
                        All Themes
                    </label>
                </div>
            </div>

            <!-- Filter Actions -->
            <div class="sidebar-section">
                <button id="applyFiltersBtn" class="btn primary">Apply Filters</button>
                <button id="resetFiltersBtn" class="btn">Reset All</button>
                <div style="text-align: center; margin-top: 12px; color: rgba(255,255,255,0.6); font-size: 12px;">
                    <span id="availablePuzzles">222,124</span> puzzles available
                </div>
            </div>

            <!-- Actions -->
            <div class="sidebar-section">
                <h3>Actions</h3>
                <button id="statsBtn" class="btn">üìä Statistics</button>
                <button id="analyticsBtn" class="btn">üìà Analytics</button>
                <button id="achievementsBtn" class="btn">üèÜ Achievements</button>
                <button id="leaderboardBtn" class="btn">ü•á Leaderboard</button>
                <button id="resetProgressBtn" class="btn" style="color: var(--danger);">üîÑ Reset Progress</button>
            </div>
        </aside>

        <!-- Center - Massive Chess Board -->
        <div class="board-center">
            <div class="board-container">
                <div id="board"></div>
            </div>
        </div>

        <!-- Right Sidebar - Game Controls -->
        <aside class="right-sidebar">
            <!-- Timer & Status -->
            <div class="sidebar-section">
                <h3>Timer & Status</h3>
                <div class="timer-display">
                    <div class="timer" id="timer">00:00</div>
                    <div class="puzzle-info">
                        <div><span class="category-badge" id="puzzleCategory">Tactics</span></div>
                        <div><span class="difficulty-stars" id="puzzleDifficulty">‚≠ê</span></div>
                        <div><span class="puzzle-counter" id="puzzleCounter">1 / 15</span></div>
                        <div><span class="side-to-move" id="sideToMove">White to move</span></div>
                        <div><span id="puzzleTheme">Fork</span></div>
                    </div>
                    <div class="rush-info" id="rushInfo" style="display: none;">
                        <div style="color: var(--success); font-weight: 600;">Score: <span id="rushScore">0</span></div>
                    </div>
                    <div class="rating-change" id="ratingChange"></div>
                </div>
            </div>

            <!-- Game Controls -->
            <div class="sidebar-section">
                <h3>Controls</h3>
                <div class="controls-grid">
                    <button id="hintBtn" class="control-btn">üí° Hint</button>
                    <button id="analyzeBtn" class="control-btn">üîç Analyze</button>
                    <button id="resetPuzzleBtn" class="control-btn">‚Ü∫ Reset</button>
                    <button id="solutionBtn" class="control-btn">üëÅÔ∏è Solution</button>
                    <button id="nextBtn" class="control-btn primary">Next Puzzle ‚Üí</button>
                </div>
            </div>

            <!-- Move History -->
            <div class="sidebar-section">
                <h3>Move History</h3>
                <div class="moves-container">
                    <div class="moves" id="moveHistory"></div>
                </div>
            </div>

            <!-- Solution Display -->
            <div class="sidebar-section move-display" id="solutionDisplay" style="display: none;">
                <h3>Solution</h3>
                <div class="moves-container">
                    <div class="moves" id="moveList"></div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Modals remain the same -->
    <div id="statsModal" class="modal" style="display: none;">
        <div class="modal-content" style="background: var(--dark); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 40px; max-width: 600px; width: 90%;">
            <span class="close" style="position: absolute; top: 20px; right: 20px; font-size: 28px; color: rgba(255,255,255,0.5); cursor: pointer;">&times;</span>
            <h2>Training Statistics</h2>
            <div id="statsContent"></div>
        </div>
    </div>

    <div id="achievementsModal" class="modal" style="display: none;">
        <div class="modal-content" style="background: var(--dark); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 40px; max-width: 600px; width: 90%;">
            <span class="close" style="position: absolute; top: 20px; right: 20px; font-size: 28px; color: rgba(255,255,255,0.5); cursor: pointer;">&times;</span>
            <h2>Achievements</h2>
            <div id="achievementsContent"></div>
        </div>
    </div>

    <div id="leaderboardModal" class="modal" style="display: none;">
        <div class="modal-content" style="background: var(--dark); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 40px; max-width: 600px; width: 90%;">
            <span class="close" style="position: absolute; top: 20px; right: 20px; font-size: 28px; color: rgba(255,255,255,0.5); cursor: pointer;">&times;</span>
            <h2>üèÜ Leaderboard</h2>
            <div class="leaderboard-tabs">
                <button class="leaderboard-tab active" data-timeframe="all">All Time</button>
                <button class="leaderboard-tab" data-timeframe="monthly">This Month</button>
                <button class="leaderboard-tab" data-timeframe="weekly">This Week</button>
                <button class="leaderboard-tab" data-timeframe="daily">Today</button>
            </div>
            <div id="leaderboardContent"></div>
        </div>
    </div>

    <div id="analyticsModal" class="modal" style="display: none;">
        <div class="modal-content" style="background: var(--dark); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 40px; max-width: 600px; width: 90%;">
            <span class="close" style="position: absolute; top: 20px; right: 20px; font-size: 28px; color: rgba(255,255,255,0.5); cursor: pointer;">&times;</span>
            <h2>üìà Performance Analytics</h2>
            <div class="analytics-tabs">
                <button class="analytics-tab active" data-view="overview">Overview</button>
                <button class="analytics-tab" data-view="progress">Progress</button>
                <button class="analytics-tab" data-view="patterns">Patterns</button>
                <button class="analytics-tab" data-view="history">History</button>
            </div>
            <div id="analyticsContent"></div>
        </div>
    </div>

    <!-- Success Notification -->
    <div class="success-notification" id="successNotification">
        <span class="success-icon">‚úì</span>
        <span id="successMessage" class="success-message">Puzzle solved!</span>
    </div>

    <!-- General Notification -->
    <div class="notification" id="notification"></div>

    <!-- Auth Modals -->
    <div class="auth-modal" id="loginModal" style="display: none;">
        <div class="auth-modal-content" style="background: var(--dark); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 40px; max-width: 400px; width: 90%;">
            <span class="close" id="loginClose" style="position: absolute; top: 20px; right: 20px; font-size: 28px; color: rgba(255,255,255,0.5); cursor: pointer;">&times;</span>
            <h2>Login</h2>
            <form id="loginForm">
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="loginUsername" style="display: block; margin-bottom: 8px;">Username:</label>
                    <input type="text" id="loginUsername" required style="width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;">
                </div>
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="loginPassword" style="display: block; margin-bottom: 8px;">Password:</label>
                    <input type="password" id="loginPassword" required style="width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;">
                </div>
                <button type="submit" class="btn primary" style="width: 100%; margin-bottom: 16px;">Login</button>
                <div class="auth-switch" style="text-align: center;">
                    Don't have an account? <a href="#" id="switchToSignup" style="color: var(--primary);">Sign up</a>
                </div>
            </form>
        </div>
    </div>

    <div class="auth-modal" id="signupModal" style="display: none;">
        <div class="auth-modal-content" style="background: var(--dark); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 40px; max-width: 400px; width: 90%;">
            <span class="close" id="signupClose" style="position: absolute; top: 20px; right: 20px; font-size: 28px; color: rgba(255,255,255,0.5); cursor: pointer;">&times;</span>
            <h2>Sign Up</h2>
            <form id="signupForm">
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="signupUsername" style="display: block; margin-bottom: 8px;">Username:</label>
                    <input type="text" id="signupUsername" required minlength="3" style="width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;">
                </div>
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="signupEmail" style="display: block; margin-bottom: 8px;">Email:</label>
                    <input type="email" id="signupEmail" required style="width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;">
                </div>
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="signupPassword" style="display: block; margin-bottom: 8px;">Password:</label>
                    <input type="password" id="signupPassword" required minlength="6" style="width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;">
                </div>
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="confirmPassword" style="display: block; margin-bottom: 8px;">Confirm Password:</label>
                    <input type="password" id="confirmPassword" required minlength="6" style="width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white;">
                </div>
                <button type="submit" class="btn primary" style="width: 100%; margin-bottom: 16px;">Sign Up</button>
                <div class="auth-switch" style="text-align: center;">
                    Already have an account? <a href="#" id="switchToLogin" style="color: var(--primary);">Login</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
    <script src="userAuth.js"></script>
    <script src="matesIn2Database.js"></script>
    <script src="puzzleDatabase.js"></script>
    <script src="training.js"></script>
    <script src="rushMode.js"></script>
    <script src="focusedMode.js"></script>
    <script src="trainerApp.js"></script>

    <style>
    /* Modal positioning */
    .modal, .auth-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        z-index: 3000;
        align-items: center;
        justify-content: center;
    }
    .modal.show, .auth-modal.show { display: flex; }
    </style>
</body>
</html>